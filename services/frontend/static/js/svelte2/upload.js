!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("../../../../../../../../../../../../static/vendor/jschardet/jschardet.min.js"),require("../../../../../../../../../../../../static/vendor/xlsx/xlsx.full.min.js")):"function"==typeof define&&define.amd?define("svelte/upload",["../../../../../../../../../../../../static/vendor/jschardet/jschardet.min","../../../../../../../../../../../../static/vendor/xlsx/xlsx.full.min"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).upload=e(t.jschardet)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=e(t);function s(){}function r(t,e){for(var a in e)t[a]=e[a];return t}function n(t,e){for(var a in e)t[a]=1;return t}function o(t,e){t.appendChild(e)}function i(t,e,a){t.insertBefore(e,a)}function c(t){t.parentNode.removeChild(t)}function d(t,e){for(var a=0;a<t.length;a+=1)t[a]&&t[a].d(e)}function l(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function u(t,e,a,s){t.addEventListener(e,a,s)}function f(t,e,a,s){t.removeEventListener(e,a,s)}function p(t,e,a){null==a?t.removeAttribute(e):t.setAttribute(e,a)}function _(t,e){t.data=""+e}function v(t,e){for(var a=0;a<t.options.length;a+=1){var s=t.options[a];if(s.__value===e)return void(s.selected=!0)}}function g(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function m(){return Object.create(null)}function y(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function b(t,e){return t!=t?e==e:t!==e}function D(t,e){var a=t in this._handlers&&this._handlers[t].slice();if(a)for(var s=0;s<a.length;s+=1){var r=a[s];if(!r.__calling)try{r.__calling=!0,r.call(this,e)}finally{r.__calling=!1}}}function w(t){t._lock=!0,A(t._beforecreate),A(t._oncreate),A(t._aftercreate),t._lock=!1}function x(){return this._state}function N(t,e){t._handlers=m(),t._slots=m(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function T(t,e){var a=this._handlers[t]||(this._handlers[t]=[]);return a.push(e),{cancel:function(){var t=a.indexOf(e);~t&&a.splice(t,1)}}}function A(t){for(;t&&t.length;)t.shift()()}var S={destroy:function(t){this.destroy=s,this.fire("destroy"),this.set=s,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:x,fire:D,on:T,set:function(t){this._set(r({},t)),this.root._lock||w(this.root)},_recompute:s,_set:function(t){var e=this._state,a={},s=!1;for(var n in t=r(this._staged,t),this._staged={},t)this._differs(t[n],e[n])&&(a[n]=s=!0);s&&(this._state=r(r({},e),t),this._recompute(a,this._state),this._bind&&this._bind(a,this._state),this._fragment&&(this.fire("state",{changed:a,current:this._state,previous:e}),this._fragment.p(a,this._state),this.fire("update",{changed:a,current:this._state,previous:e})))},_stage:function(t){r(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:y};const k={};function j(t="core"){"chart"===t?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(k[t]=window.__dw.vis.meta.locale||{}):k[t]="core"===t?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[t])}function P(t,e="core"){if(t=t.trim(),k[e]||j(e),!k[e][t])return"MISSING:"+t;var a=k[e][t];return"string"==typeof a&&arguments.length>2&&(a=a.replace(/\$(\d)/g,(t,e)=>(e=2+Number(e),void 0===arguments[e]?t:arguments[e]))),a}function F(t){N(this,t),this._state=r({placeholder:P("upload / paste here")},t.data),this._intro=!0,this._fragment=function(t,e){var a,s,r,n=!1;function d(){n=!0,t.set({chartData:r.value}),n=!1}return{c(){var t,n;a=l("form"),s=l("div"),u(r=l("textarea"),"input",d),r.readOnly=e.readonly,r.id="upload-data-text",t="resize",n="none",r.style.setProperty(t,n),r.placeholder=e.placeholder,r.className="svelte-kl1kny",s.className="control-group",a.className="upload-form"},m(t,n){i(t,a,n),o(a,s),o(s,r),r.value=e.chartData},p(t,e){!n&&t.chartData&&(r.value=e.chartData),t.readonly&&(r.readOnly=e.readonly),t.placeholder&&(r.placeholder=e.placeholder)},d(t){t&&c(a),f(r,"input",d)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function z({changed:t,current:e}){if(t.selectedDataset&&"--"!==e.selectedDataset){const t=e.selectedDataset;setTimeout(()=>{this.set({chartData:t.data})},100),t.presets&&Object.keys(t.presets).forEach(e=>{this.store.get().dw_chart.set(e,t.presets[e])})}}function C(t,e,a){const s=Object.create(t);return s.dataset=e[a],s}function M(t,e,a){const s=Object.create(t);return s.group=e[a],s}function O(t,e){var a,s,r,n=e.dataset.title;return{c(){a=l("option"),s=h(n),a.__value=r=e.dataset,a.value=a.__value,a.className="demo-dataset"},m(t,e){i(t,a,e),o(a,s)},p(t,e){t.datasetsArray&&n!==(n=e.dataset.title)&&_(s,n),t.datasetsArray&&r!==(r=e.dataset)&&(a.__value=r),a.value=a.__value},d(t){t&&c(a)}}}function U(t,e){for(var a,s,r=e.group.datasets,n=[],o=0;o<r.length;o+=1)n[o]=O(0,C(e,r,o));return{c(){a=l("optgroup");for(var t=0;t<n.length;t+=1)n[t].c();p(a,"label",s=e.group.type)},m(t,e){i(t,a,e);for(var s=0;s<n.length;s+=1)n[s].m(a,null)},p(t,e){if(t.datasetsArray){r=e.group.datasets;for(var o=0;o<r.length;o+=1){const s=C(e,r,o);n[o]?n[o].p(t,s):(n[o]=O(0,s),n[o].c(),n[o].m(a,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}t.datasetsArray&&s!==(s=e.group.type)&&p(a,"label",s)},d(t){t&&c(a),d(n,t)}}}function E(t){N(this,t),this._state=r({selectedDataset:"--"},t.data),this._recompute({datasets:1},this._state),this._intro=!0,this._handlers.update=[z],this._fragment=function(t,e){for(var a,s,r,n,p,_,m,y,b,D,w=P("upload / quick help"),x=P("upload / try a dataset"),N=P("upload / sample dataset"),T=!1,A=e.datasetsArray,S=[],k=0;k<A.length;k+=1)S[k]=U(t,M(e,A,k));function j(){T=!0,t.set({selectedDataset:g(y)}),T=!1}return{c(){a=l("p"),s=h(w),r=h("\n\n"),n=l("div"),p=l("p"),_=h(x),m=h("\n    "),y=l("select"),b=l("option"),D=h(N);for(var o=0;o<S.length;o+=1)S[o].c();b.__value="--",b.value=b.__value,u(y,"change",j),"selectedDataset"in e||t.root._beforecreate.push(j),y.disabled=e.readonly,y.id="demo-datasets",y.className="svelte-16u58l0",n.className="demo-datasets"},m(t,c){i(t,a,c),o(a,s),i(t,r,c),i(t,n,c),o(n,p),o(p,_),o(n,m),o(n,y),o(y,b),o(b,D);for(var d=0;d<S.length;d+=1)S[d].m(y,null);v(y,e.selectedDataset)},p(e,a){if(e.datasetsArray){A=a.datasetsArray;for(var s=0;s<A.length;s+=1){const r=M(a,A,s);S[s]?S[s].p(e,r):(S[s]=U(t,r),S[s].c(),S[s].m(y,null))}for(;s<S.length;s+=1)S[s].d(1);S.length=A.length}!T&&e.selectedDataset&&v(y,a.selectedDataset),e.readonly&&(y.disabled=a.readonly)},d(t){t&&(c(a),c(r),c(n)),d(S,t),f(y,"change",j)}}}(this,this._state),this.root._oncreate.push(()=>{this.fire("update",{changed:n({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),w(this))}function L({changed:t,current:e}){t.sheets&&e.sheets.length>1?setTimeout(()=>{this.set({selected:e.sheets[0]})},300):t.sheets&&1===e.sheets.length&&(this.set({chartData:e.sheets[0].csv}),this.store.get().dw_chart.onNextSave(()=>{window.location.href="describe"})),t.selected&&e.selected.csv&&this.set({chartData:e.selected.csv})}function R(t,e,a){const s=Object.create(t);return s.sheet=e[a],s}function H(t,e){var a,r,n=P("edit / upload / success-import");return{c(){a=l("p"),r=h(n)},m(t,e){i(t,a,e),o(a,r)},p:s,d(t){t&&c(a)}}}function $(t,e){for(var a,s,r,n,p,_=P("upload / select sheet"),m=!1,y=e.sheets,b=[],D=0;D<y.length;D+=1)b[D]=B(t,R(e,y,D));function w(){m=!0,t.set({selected:g(n)}),m=!1}return{c(){a=l("p"),s=h(_),r=h("\n    "),n=l("select");for(var o=0;o<b.length;o+=1)b[o].c();u(n,"change",w),"selected"in e||t.root._beforecreate.push(w),n.disabled=p=!e.sheets.length,n.className="svelte-16u58l0"},m(t,c){i(t,a,c),o(a,s),i(t,r,c),i(t,n,c);for(var d=0;d<b.length;d+=1)b[d].m(n,null);v(n,e.selected)},p(e,a){if(e.sheets){y=a.sheets;for(var s=0;s<y.length;s+=1){const r=R(a,y,s);b[s]?b[s].p(e,r):(b[s]=B(t,r),b[s].c(),b[s].m(n,null))}for(;s<b.length;s+=1)b[s].d(1);b.length=y.length}!m&&e.selected&&v(n,a.selected),e.sheets&&p!==(p=!a.sheets.length)&&(n.disabled=p)},d(t){t&&(c(a),c(r),c(n)),d(b,t),f(n,"change",w)}}}function q(t,e){var a,r=P("upload / parsing-xls");return{c(){(a=l("div")).className="alert alert-info"},m(t,e){i(t,a,e),a.innerHTML=r},p:s,d(t){t&&c(a)}}}function B(t,e){var a,s,r,n=e.sheet.name;return{c(){a=l("option"),s=h(n),a.__value=r=e.sheet,a.value=a.__value},m(t,e){i(t,a,e),o(a,s)},p(t,e){t.sheets&&n!==(n=e.sheet.name)&&_(s,n),t.sheets&&r!==(r=e.sheet)&&(a.__value=r),a.value=a.__value},d(t){t&&c(a)}}}function I(t){N(this,t),this._state=r({selected:!1,chartData:"",sheets:[]},t.data),this._intro=!0,this._handlers.update=[L],this._fragment=function(t,e){var a;function s(t){return t.sheets.length?t.sheets.length>1?$:H:q}var r=s(e),n=r(t,e);return{c(){a=l("div"),n.c()},m(t,e){i(t,a,e),n.m(a,null)},p(e,o){r===(r=s(o))&&n?n.p(e,o):(n.d(1),(n=r(t,o)).c(),n.m(a,null))},d(t){t&&c(a),n.d()}}}(this,this._state),this.root._oncreate.push(()=>{this.fire("update",{changed:n({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),w(this))}function X(t,e){var s=new FileReader;s.onload=function(){try{var r=new Uint8Array(s.result),n="";let i=0;for(var o=0;o<r.length;++o)r[o]>122&&i++,n+=String.fromCharCode(r[o]);let c=a.default.detect(n);c.confidence<=.95&&i<10&&(c.encoding="utf-8"),(s=new FileReader).onload=()=>e(null,s.result),s.readAsText(t,c.encoding)}catch(t){console.warn(t),e(null,s.result)}},s.readAsArrayBuffer(t)}let G;r(F.prototype,S),r(E.prototype,S),E.prototype._recompute=function(t,e){t.datasets&&this._differs(e.datasetsArray,e.datasetsArray=function({datasets:t}){return Object.keys(t).map(e=>t[e])}(e))&&(t.datasetsArray=!0)},r(I.prototype,S);const W=[{id:"copy",title:P("upload / copy-paste"),longTitle:P("upload / copy-paste / long"),icon:"fa fa-clipboard",mainPanel:F,sidebar:E,action(){}},{id:"upload",title:P("upload / upload-csv"),longTitle:P("upload / upload-csv / long"),icon:"fa-file-excel-o fa",mainPanel:F,sidebar:E,isFileUpload:!0,async onFileUpload(t){const e=t.target.files[0];"text/"===e.type.substr(0,5)||".csv"===e.name.substr(e.name.length-4)?(G.set({Sidebar:E}),X(e,async(t,e)=>{if(t)return console.error("could not read file",t);G.set({chartData:e})})):"application/"===e.type.substr(0,12)?(G.set({Sidebar:I,sheets:[]}),function(t,e){const a="undefined"!=typeof FileReader&&(FileReader.prototype||{}).readAsBinaryString,s=new FileReader;s.onload=function(){try{const t=a?s.result:new Uint8Array(s.result),r=XLSX.read(t,{type:a?"binary":"array"});e(null,r.SheetNames.map(t=>({name:t,sheet:r.Sheets[t],csv:XLSX.utils.sheet_to_csv(r.Sheets[t])})))}catch(t){console.error(t),e(null,s.result)}},s.readAsBinaryString(t)}(e,(t,e)=>{if(t)return G.set({error:t});G.set({sheets:e})})):(console.error(e.type),console.error(e),G.set({error:P("upload / csv-required")}))},action(){}}];var J={addButton(t){W.push(t),this.set({buttons:W});const{defaultMethod:e}=this.get();t.id===e&&this.btnAction(t)},btnAction(t){if(this.set({active:t}),"external-data"!==t.id){const{dw_chart:t}=this.store.get();t.get("externalData")&&t.set("externalData","")}let e=t.id;"upload"===t.id&&(e="copy",setTimeout(()=>{},1e3));const{dw_chart:a}=this.store.get();a.set("metadata.data.upload-method",e),t.action&&t.action(),t.mainPanel&&this.set({MainPanel:t.mainPanel}),t.sidebar&&this.set({Sidebar:t.sidebar})},btnUpload(t,e){const{dw_chart:a}=this.store.get();t.onFileUpload&&t.onFileUpload(e,a)},dragStart(t){const{active:e}=this.get();(function(t){if(!t.dataTransfer)return!!t.target&&!!t.target.files;return Array.prototype.some.call(t.dataTransfer.types,t=>"Files"===t||"application/x-moz-file"===t)&&Array.prototype.some.call(t.dataTransfer.items,t=>"file"===t.kind&&t.type.startsWith("text/"))})(t)&&"copy"===e.id&&(t.preventDefault(),this.set({dragover:!0}))},resetDrag(){this.set({dragover:!1})},onFileDrop(t){const{active:e}=this.get(),{dw_chart:a}=this.store.get();if("copy"!==e.id)return;this.resetDrag(),t.preventDefault();const s=[];if(t.dataTransfer.items){for(let e=0;e<t.dataTransfer.items.length;e++)"file"===t.dataTransfer.items[e].kind&&s.push(t.dataTransfer.items[e].getAsFile());t.dataTransfer.items.clear()}else{for(let e=0;e<t.dataTransfer.files.length;e++)s.push(t.dataTransfer.files[e]);t.dataTransfer.items.clear()}for(let t=0;t<s.length;t++)if("text/"===s[t].type.substr(0,5))return X(s[t],async(t,e)=>{if(t)return console.error("could not read file",t);this.set({chartData:e}),a.onNextSave(()=>{window.location.href="describe"})})}};function K(){G=this;const{dw_chart:t}=this.store.get(),e=t.get("metadata.data.upload-method","copy");this.set({defaultMethod:e}),W.forEach(t=>{t.id===e&&this.set({active:t})})}function Q({changed:t,current:e}){t.chartData&&this.fire("change",e.chartData)}function V(t){const{component:e,ctx:a}=this._svelte;e.btnAction(a.btn)}function Y(t){const{component:e,ctx:a}=this._svelte;e.btnUpload(a.btn,t)}function Z(t,e,a){const s=Object.create(t);return s.btn=e[a],s}function tt(t,e){var a,s=P("upload / drag-csv-here");return{c(){(a=l("div")).className="draginfo svelte-2180z6"},m(t,e){i(t,a,e),a.innerHTML=s},d(t){t&&c(a)}}}function et(t,e){var a;return{c(){(a=l("input"))._svelte={component:t,ctx:e},u(a,"change",Y),a.accept=".csv, .tsv, .txt, .xlsx, .xls, .ods, .dbf",a.className="file-upload svelte-2180z6",p(a,"type","file")},m(t,e){i(t,a,e)},p(t,s){e=s,a._svelte.ctx=e},d(t){t&&c(a),f(a,"change",Y)}}}function at(t,e){var a,s,r,n,d,p,v,g,m,y=e.btn.title,b=e.btn.isFileUpload&&et(t,e);return{c(){a=l("li"),s=l("label"),b&&b.c(),r=h("\n                            "),n=l("i"),p=h("\n                            "),v=l("span"),g=h(y),n.className=d=e.btn.icon+" svelte-2180z6",v.className="svelte-2180z6",s.className="svelte-2180z6",a._svelte={component:t,ctx:e},u(a,"click",V),a.className=m="action "+(e.active==e.btn?"active":"")+" svelte-2180z6"},m(t,e){i(t,a,e),o(a,s),b&&b.m(s,null),o(s,r),o(s,n),o(s,p),o(s,v),o(v,g)},p(o,i){(e=i).btn.isFileUpload?b?b.p(o,e):((b=et(t,e)).c(),b.m(s,r)):b&&(b.d(1),b=null),o.buttons&&d!==(d=e.btn.icon+" svelte-2180z6")&&(n.className=d),o.buttons&&y!==(y=e.btn.title)&&_(g,y),a._svelte.ctx=e,(o.active||o.buttons)&&m!==(m="action "+(e.active==e.btn?"active":"")+" svelte-2180z6")&&(a.className=m)},d(t){t&&c(a),b&&b.d(),f(a,"click",V)}}}function st(t,e){var a,s,r,n;function d(e){t.set({error:!1})}return{c(){a=l("div"),(s=l("div")).textContent="âœ•",r=h("\n                    "),n=l("noscript"),u(s,"click",d),s.className="action close",a.className="alert alert-error"},m(t,c){i(t,a,c),o(a,s),o(a,r),o(a,n),n.insertAdjacentHTML("afterend",e.error)},p(t,e){t.error&&(!function(t){for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling)}(n),n.insertAdjacentHTML("afterend",e.error))},d(t){t&&c(a),f(s,"click",d)}}}function rt(t){N(this,t),this._state=r({dragover:!1,MainPanel:F,Sidebar:E,active:W[0],buttons:W,sheets:[],chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},t.data),this._intro=!0,this._handlers.state=[Q],Q.call(this,{changed:n({},this._state),current:this._state}),this._fragment=function(t,e){for(var a,s,r,n,p,v,g,m,y,b,D,w,x,N,T,A,S,k,j,F,z,C,M=P("upload / title"),O=e.active.longTitle||e.active.title,U={},E={},L=P("Proceed"),R=e.dragover&&tt(),H=e.buttons,$=[],q=0;q<H.length;q+=1)$[q]=at(t,Z(e,H,q));var B=e.error&&st(t,e),I=e.Sidebar;function X(e){var a={};return void 0!==e.chartData&&(a.chartData=e.chartData,U.chartData=!0),void 0!==e.readonly&&(a.readonly=e.readonly,U.readonly=!0),void 0!==e.sheets&&(a.sheets=e.sheets,U.sheets=!0),void 0!==e.datasets&&(a.datasets=e.datasets,U.datasets=!0),{root:t.root,store:t.store,data:a,_bind(e,a){var s={};!U.chartData&&e.chartData&&(s.chartData=a.chartData),!U.readonly&&e.readonly&&(s.readonly=a.readonly),!U.sheets&&e.sheets&&(s.sheets=a.sheets),!U.datasets&&e.datasets&&(s.datasets=a.datasets),t._set(s),U={}}}}if(I){var G=new I(X(e));t.root._beforecreate.push(()=>{G._bind({chartData:1,readonly:1,sheets:1,datasets:1},G.get())})}var W=e.MainPanel;function J(e){var a={};return void 0!==e.chartData&&(a.chartData=e.chartData,E.chartData=!0),void 0!==e.readonly&&(a.readonly=e.readonly,E.readonly=!0),{root:t.root,store:t.store,data:a,_bind(e,a){var s={};!E.chartData&&e.chartData&&(s.chartData=a.chartData),!E.readonly&&e.readonly&&(s.readonly=a.readonly),t._set(s),E={}}}}if(W){var K=new W(J(e));t.root._beforecreate.push(()=>{K._bind({chartData:1,readonly:1},K.get())})}function Q(e){t.onFileDrop(e)}function V(e){t.dragStart(e)}function Y(e){t.dragStart(e)}function et(e){t.resetDrag()}function rt(e){t.resetDrag()}return{c(){a=l("div"),R&&R.c(),s=h("\n\n    \n    "),r=l("div"),n=l("div"),p=l("div"),v=l("h3"),g=h("\n\n                "),m=l("ul");for(var t=0;t<$.length;t+=1)$[t].c();y=h("\n\n                "),B&&B.c(),b=h("\n\n                "),D=l("h4"),w=h(O),x=h("\n\n                "),G&&G._fragment.c(),N=h("\n        "),T=l("div"),K&&K._fragment.c(),A=h("\n\n            "),S=l("div"),k=l("a"),j=h(L),F=h(" "),z=l("i"),m.className="import-methods svelte-2180z6",D.className="svelte-2180z6",p.className="sidebar",n.className="column is-5",z.className="icon-chevron-right icon-white",k.href="describe",k.className="submit btn btn-primary svelte-2180z6",k.id="describe-proceed",S.className="buttons pull-right",T.className="column",r.className="columns is-variable is-5 is-8-widescreen",r.style.cssText=C=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"",u(a,"drop",Q),u(a,"dragover",V),u(a,"dragenter",Y),u(a,"dragend",et),u(a,"dragleave",rt),a.className="chart-editor dw-create-upload upload-data"},m(t,e){i(t,a,e),R&&R.m(a,null),o(a,s),o(a,r),o(r,n),o(n,p),o(p,v),v.innerHTML=M,o(p,g),o(p,m);for(var c=0;c<$.length;c+=1)$[c].m(m,null);o(p,y),B&&B.m(p,null),o(p,b),o(p,D),o(D,w),o(p,x),G&&G._mount(p,null),o(r,N),o(r,T),K&&K._mount(T,null),o(T,A),o(T,S),o(S,k),o(k,j),o(k,F),o(k,z)},p(n,o){if((e=o).dragover?R||((R=tt()).c(),R.m(a,s)):R&&(R.d(1),R=null),n.active||n.buttons){H=e.buttons;for(var i=0;i<H.length;i+=1){const a=Z(e,H,i);$[i]?$[i].p(n,a):($[i]=at(t,a),$[i].c(),$[i].m(m,null))}for(;i<$.length;i+=1)$[i].d(1);$.length=H.length}e.error?B?B.p(n,e):((B=st(t,e)).c(),B.m(p,b)):B&&(B.d(1),B=null),n.active&&O!==(O=e.active.longTitle||e.active.title)&&_(w,O);var c={};!U.chartData&&n.chartData&&(c.chartData=e.chartData,U.chartData=void 0!==e.chartData),!U.readonly&&n.readonly&&(c.readonly=e.readonly,U.readonly=void 0!==e.readonly),!U.sheets&&n.sheets&&(c.sheets=e.sheets,U.sheets=void 0!==e.sheets),!U.datasets&&n.datasets&&(c.datasets=e.datasets,U.datasets=void 0!==e.datasets),I!==(I=e.Sidebar)?(G&&G.destroy(),I?(G=new I(X(e)),t.root._beforecreate.push(()=>{const t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),void 0===e.sheets&&(t.sheets=1),void 0===e.datasets&&(t.datasets=1),G._bind(t,G.get())}),G._fragment.c(),G._mount(p,null)):G=null):I&&(G._set(c),U={});var d={};!E.chartData&&n.chartData&&(d.chartData=e.chartData,E.chartData=void 0!==e.chartData),!E.readonly&&n.readonly&&(d.readonly=e.readonly,E.readonly=void 0!==e.readonly),W!==(W=e.MainPanel)?(K&&K.destroy(),W?(K=new W(J(e)),t.root._beforecreate.push(()=>{const t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),K._bind(t,K.get())}),K._fragment.c(),K._mount(T,A)):K=null):W&&(K._set(d),E={}),n.dragover&&C!==(C=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"")&&(r.style.cssText=C)},d(t){t&&c(a),R&&R.d(),d($,t),B&&B.d(),G&&G.destroy(),K&&K.destroy(),f(a,"drop",Q),f(a,"dragover",V),f(a,"dragenter",Y),f(a,"dragend",et),f(a,"dragleave",rt)}}}(this,this._state),this.root._oncreate.push(()=>{K.call(this),this.fire("update",{changed:n({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),w(this))}function nt(t,e){this._handlers={},this._dependents=[],this._computed=m(),this._sortedComputedProperties=[],this._state=r({},t),this._differs=e&&e.immutable?b:y}r(rt.prototype,S),r(rt.prototype,J),r(nt.prototype,{_add(t,e){this._dependents.push({component:t,props:e})},_init(t){const e={};for(let a=0;a<t.length;a+=1){const s=t[a];e["$"+s]=this._state[s]}return e},_remove(t){let e=this._dependents.length;for(;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set(t,e){const a=this._state;this._state=r(r({},a),t);for(let t=0;t<this._sortedComputedProperties.length;t+=1)this._sortedComputedProperties[t].update(this._state,e);this.fire("state",{changed:e,previous:a,current:this._state}),this._dependents.filter(t=>{const a={};let s=!1;for(let r=0;r<t.props.length;r+=1){const n=t.props[r];n in e&&(a["$"+n]=this._state[n],s=!0)}if(s)return t.component._stage(a),!0}).forEach(t=>{t.component.set({})}),this.fire("update",{changed:e,previous:a,current:this._state})},_sortComputedProperties(){const t=this._computed,e=this._sortedComputedProperties=[],a=m();let s;function r(n){const o=t[n];o&&(o.deps.forEach(t=>{if(t===s)throw new Error(`Cyclical dependency detected between ${t} <-> ${n}`);r(t)}),a[n]||(a[n]=!0,e.push(o)))}for(const t in this._computed)r(s=t)},compute(t,e,a){let s;const n={deps:e,update:(r,n,o)=>{const i=e.map(t=>(t in n&&(o=!0),r[t]));if(o){const e=a.apply(null,i);this._differs(e,s)&&(s=e,n[t]=!0,r[t]=s)}}};this._computed[t]=n,this._sortComputedProperties();const o=r({},this._state),i={};n.update(o,i,!0),this._set(o,i)},fire:D,get:x,on:T,set(t){const e=this._state,a=this._changed={};let s=!1;for(const r in t){if(this._computed[r])throw new Error(`'${r}' is a read-only computed property`);this._differs(t[r],e[r])&&(a[r]=s=!0)}s&&this._set(t,a)}});return{App:rt,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new nt({})}}));
